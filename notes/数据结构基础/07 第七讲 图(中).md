# 第七讲 图(中)

## 7.1 最短路径问题

### 7.1.1 概述

如何抽象出最短路径

+ 最短路径问题的抽象
  + 在网络中，求两个不同顶点之间的所有路径中，边的权值之和最小的那一条路径
    + 这条路径就是两点之间的最短路径(Shoretst Path)
    + 第一个顶点称为源点(Source)
    + 最后一个顶点为终点(Destination)
  + 问题分类
    + 单源最短路径问题：从某固定源点出发，求其到所有其他顶点的最短路径
      + （有向）无权图
      + （有向）有权图
    + 多源最短路径问题：求任意两顶点间的最短路径

### 7.1.2 无权图的单源最短路

无权图的单源最短路算法

+ 按照递增(非递减)的顺序找出到各个顶点的最短路
  + 广度优先搜索(BFS)
  + 相比BFS，需要使用一个替代方案记录是否被访问
    + 可以使用一个数组记录距离
    + 还需要存储一条路径
    + 算法时间复杂度 $T=O(|N|+||E)$

### 7.1.2-S 算法示例

+ 无权图算法示例

### 7.1.3 有权图的单源最短路算法

+ 有权图最短路径不一定是经过顶点数最少的路径
+ 当路径权重为负时，可能出现负值圈(negative-cost cycle)
+ 思路： 按照递增（非递减）的顺序找出到各个顶点的最短路
+ Dijikstra算法
  + 令S={源点s + 已经确定了最短路径的顶点vi}
  + 对任一未收录的顶点v，定义dist[v]为s到v的最短路径长度，但该路径仅经过S中的顶点。即路径{s->(vi\in s)->v}的最小长度
  + 若路径是按照递增（非递减）的顺序生成的，则
    + 真正的最短路必须只经过S中的顶点
    + 每次从未收录的顶点中选一个dist最小的收录（贪心）
    + 增加一个v进入S，可能会影响到其他顶点的长度
  + Dijikstra算法定义的距离不能解决负数权重的问题
  + 扫描方法
    + 直接扫描所有未收录顶点（对稠密图效果好）
      + $T=O(|V|^2+|E|)$
    + 将dist存在最小堆中 ~O(log|V|)（对稀疏图效果好）
      + 更新dist[w]-O(log|V|)
      + T = O(|V|log|V|+|E|log|V|)=O(|E|log|V|)

### 7.1.3-S 算法示例

+ 有权图算法示例

### 7.1.4 多源最短路算法

+ 方法1： 直接将单源最短路算法调用|V|遍
  + $T=O(|V|^3+|E|\times|V|)$
+ 方法2： Floyd算法
  + $T=O(|V|^3)$
+ Floyd 算法
  + 递归路径打印
  + 路径逐渐生成
